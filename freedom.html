<!DOCTYPE html>
<html lang="de">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1.0">
	<title>Finanzielle Freiheit – Bargeldkonto</title>
	<link rel="stylesheet" href="styles.css">
	<style>
		body { padding: 1rem; }
		.freedom-mode-badge { background: var(--primary); color:#fff; padding:4px 8px; border-radius:4px; font-size:.8rem; margin-left:.5rem; }
		.container { max-width: 1200px; margin: 0 auto; }
		/* Two-column layout on larger screens, stack on small */
		.sheet { flex: 1 1 48%; min-width: 320px; }
		.sheet-header { display:flex; align-items:center; gap:.75rem; flex-wrap:wrap; }
		.sheet-header h2 { margin:0; display:flex; align-items:center; gap:.5rem; }
		#btn-return { margin-left:auto; }
		.cashflow-line { font-size:.9rem; margin:.25rem 0 1rem; }
		.cashflow-line strong { color: var(--primary); }
		.info-box { background: var(--bg-accent, rgba(0,0,0,.05)); padding: .75rem 1rem; border-radius: 8px; margin-bottom: 1rem; line-height:1.4; }
		.balance-container { gap:.5rem; flex-wrap: wrap; }
		#entries { max-height: 65vh; overflow-y:auto; }
		.return-btn { background: var(--secondary); }

		/* Investments table styles */
		.investments-table { width: 100%; border-collapse: separate; border-spacing: 0; background: var(--surface); border: 1px solid var(--border); border-radius: 8px; overflow: hidden; box-shadow: var(--shadow); }
		.investments-table th, .investments-table td { padding: .6rem .75rem; border-bottom: 1px solid var(--border); font-size: .9rem; }
		.investments-table thead th { background: var(--secondary); color: var(--surface); text-align: left; }
		.investments-table tbody tr:last-child td { border-bottom: none; }
		.investments-table td:nth-child(2), .investments-table td:nth-child(3) { text-align: right; white-space: nowrap; }

		/* Add-entry row */
		.investment-add-row { display: grid; grid-template-columns: 1fr 140px 160px auto; gap: .5rem; margin: 0 0 .75rem; align-items: center; }
		.investment-add-row input { width: 100%; }

		@media (max-width: 900px) {
			.sheet { flex: 1 1 100%; }
			.investment-add-row { grid-template-columns: 1fr; }
		}
	</style>
</head>
<body>
	<div class="container">
		<div class="sheet bargeldkonto">
					<div class="sheet-header">
						<h2>Bargeldkonto <span class="freedom-mode-badge">Freiheit Modus</span></h2>
						<button id="btn-return" class="return-btn add-cashflow-btn" title="Zur Hauptseite zurückkehren">Zurück zur Übersicht</button>
					</div>
			<div class="info-box">
				Glückwunsch! Du bist jetzt finanziell frei. Dieser vereinfachte Modus zeigt nur dein Bargeldkonto. 
				Füge nach Belieben weitere Cashflow‑Einträge hinzu oder simuliere Ausgaben/Einnahmen. Der Kontostand startet hier bei 0 € neu.
			</div>
			<p class="cashflow-line">Monatlicher Cashflow im Freiheit Modus: <strong id="freedom-mode-cashflow">0 €</strong></p>
			<div class="balance-container">
				<button id="btn-add-cashflow" class="add-cashflow-btn" title="Einen Monat Cashflow verbuchen">Add Cashflow</button>
				<button id="btn-donate" class="add-cashflow-btn" title="10% vom monatlichen Cashflow spenden">Spenden (10%)</button>
				<button id="btn-reset" class="add-cashflow-btn" title="Kontostand & Liste zurücksetzen">Reset</button>
				<div class="balance">Aktueller Kontostand: <span id="current-balance">+0</span> €</div>
			</div>
			<div style="margin:.5rem 0 1rem;">
				<label for="manual-entry" style="display:block; font-size:.8rem; opacity:.8;">Manueller Eintrag (Enter zum Verbuchen, negative Werte für Ausgaben):</label>
				<input id="manual-entry" type="text" placeholder="€" style="max-width:220px;">
			</div>
			<ul id="entries"></ul>
		</div>
		<!-- Second column: Investments table -->
		<div class="sheet investments">
			<div class="sheet-header">
				<h2>Investitionen</h2>
			</div>
			<div class="investment-add-row" aria-label="Neue Investition hinzufügen">
				<input id="inv-name" type="text" placeholder="Name der Investition">
				<input id="inv-price" type="number" step="0.01" min="0" placeholder="Preis (€)">
				<input id="inv-cashflow" type="number" step="0.01" placeholder="Cashflow/Monat (€)">
				<button id="inv-add-btn" class="add-cashflow-btn" title="Eintrag hinzufügen">Hinzufügen</button>
			</div>
			<table class="investments-table" aria-label="Investitionsübersicht">
				<thead>
					<tr>
						<th>Investition</th>
						<th>Preis</th>
						<th>Cashflow</th>
					</tr>
				</thead>
				<tbody id="investments-body">
					<tr class="dummy-row">
						<td colspan="3" style="opacity:.7; text-align:center; padding: .9rem;">Noch keine Einträge</td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>

	<script src="js/ui-utils.js"></script>
	<script src="js/core-freedom.js"></script>
	<script>
	(function(){
		const LS_KEY = 'freedomInvestments';
		const nameEl = document.getElementById('inv-name');
		const priceEl = document.getElementById('inv-price');
		const cashflowEl = document.getElementById('inv-cashflow');
		const addBtn = document.getElementById('inv-add-btn');
		const tbody = document.getElementById('investments-body');

		const euroFmt = new Intl.NumberFormat('de-DE', { style: 'currency', currency: 'EUR' });

		function load(){
			try {
				const raw = localStorage.getItem(LS_KEY);
				const arr = raw ? JSON.parse(raw) : [];
				render(arr);
			} catch(e){ /* ignore */ }
		}

		function save(arr){
			try { localStorage.setItem(LS_KEY, JSON.stringify(arr)); } catch(e){ /* ignore */ }
		}

		function getData(){
			try {
				const raw = localStorage.getItem(LS_KEY);
				return raw ? JSON.parse(raw) : [];
			} catch(e){ return []; }
		}

		function render(arr){
			// clear
			tbody.innerHTML = '';
			if(!arr.length){
				const tr = document.createElement('tr');
				tr.className = 'dummy-row';
				const td = document.createElement('td');
				td.colSpan = 3; td.style.opacity = '.7'; td.style.textAlign = 'center'; td.style.padding = '.9rem';
				td.textContent = 'Noch keine Einträge';
				tr.appendChild(td);
				tbody.appendChild(tr);
				return;
			}
			arr.forEach(({name, price, cashflow}) => tbody.appendChild(makeRow(name, price, cashflow)));
		}

		function makeRow(name, price, cashflow){
			const tr = document.createElement('tr');
			const tdN = document.createElement('td'); tdN.textContent = name;
			const tdP = document.createElement('td'); tdP.textContent = Number.isFinite(price) ? euroFmt.format(price) : '—';
			const tdC = document.createElement('td'); tdC.textContent = Number.isFinite(cashflow) ? euroFmt.format(cashflow) : '—';
			tr.append(tdN, tdP, tdC);
			return tr;
		}

		function add(){
			const name = (nameEl.value || '').trim();
			const price = priceEl.value === '' ? NaN : parseFloat(priceEl.value);
			const cashflow = cashflowEl.value === '' ? NaN : parseFloat(cashflowEl.value);

			if(!name){ nameEl.focus(); return; }
			const arr = getData();
			arr.push({ name, price: isNaN(price)?0:price, cashflow: isNaN(cashflow)?0:cashflow });
			save(arr);
			render(arr);
			// reset inputs
			nameEl.value=''; priceEl.value=''; cashflowEl.value='';
			nameEl.focus();
		}

		addBtn?.addEventListener('click', add);
		[nameEl, priceEl, cashflowEl].forEach(el => el?.addEventListener('keydown', (e)=>{
			if(e.key === 'Enter') { e.preventDefault(); add(); }
		}));

		// init
		load();
	})();
	</script>
</body>
</html>

